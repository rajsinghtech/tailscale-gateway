---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.16.5
  name: tailscaleendpoints.gateway.tailscale.com
spec:
  group: gateway.tailscale.com
  names:
    categories:
    - tailscale-gateway
    kind: TailscaleEndpoints
    listKind: TailscaleEndpointsList
    plural: tailscaleendpoints
    singular: tailscaleendpoints
  scope: Namespaced
  versions:
  - additionalPrinterColumns:
    - description: Associated tailnet
      jsonPath: .spec.tailnet
      name: Tailnet
      type: string
    - description: Total endpoints
      jsonPath: .status.totalEndpoints
      name: Total
      type: integer
    - description: Healthy endpoints
      jsonPath: .status.healthyEndpoints
      name: Healthy
      type: integer
    - description: Created StatefulSets
      jsonPath: .status.statefulSetRefs[*].name
      name: StatefulSets
      type: integer
    - description: Last discovery sync
      jsonPath: .status.lastSync
      name: Last Sync
      type: date
    - jsonPath: .metadata.creationTimestamp
      name: Age
      type: date
    name: v1alpha1
    schema:
      openAPIV3Schema:
        description: TailscaleEndpoints is the Schema for the tailscaleendpoints API
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: |-
              TailscaleEndpointsSpec defines the desired state of TailscaleEndpoints
              TailscaleEndpoints now focuses on StatefulSet/proxy infrastructure management
            properties:
              autoDiscovery:
                description: |-
                  AutoDiscovery configures automatic endpoint discovery
                  Deprecated: Use TailscaleServices for VIP service management
                properties:
                  enabled:
                    default: true
                    description: Enabled controls whether auto-discovery is active
                    type: boolean
                  serviceDiscovery:
                    description: ServiceDiscovery configures VIP service discovery
                    properties:
                      enabled:
                        default: false
                        description: Enabled controls whether to discover Tailscale
                          VIP services
                        type: boolean
                      serviceNames:
                        description: |-
                          ServiceNames are specific VIP service names to discover
                          Format: ["svc:web-service", "svc:api-service"]
                        items:
                          type: string
                        type: array
                      serviceTags:
                        description: ServiceTags filter VIP services by ACL tags
                        items:
                          type: string
                        type: array
                    required:
                    - enabled
                    type: object
                  syncInterval:
                    default: 30s
                    description: SyncInterval defines how often to sync with Tailscale
                      API
                    type: string
                  tagSelectors:
                    description: TagSelectors define advanced tag-based discovery
                      rules
                    items:
                      description: TagSelector defines a tag-based selection rule
                      properties:
                        operator:
                          default: Exists
                          description: Operator defines the selection operator
                          enum:
                          - In
                          - NotIn
                          - Exists
                          - DoesNotExist
                          type: string
                        tag:
                          description: Tag is the full tag key (e.g., "tag:service",
                            "tag:environment")
                          type: string
                        values:
                          description: |-
                            Values are the tag values to match (for In/NotIn operators)
                            For "tag:environment", values might be ["production", "staging"]
                          items:
                            type: string
                          type: array
                      required:
                      - tag
                      type: object
                    type: array
                required:
                - enabled
                type: object
              endpoints:
                description: |-
                  Endpoints defines the mapping between Tailscale services and their network details
                  Deprecated: Use TailscaleServices for VIP service management
                items:
                  description: TailscaleEndpoint represents a service accessible via
                    Tailscale
                  properties:
                    externalTarget:
                      description: |-
                        ExternalTarget defines the external service this endpoint should route to (for Envoy Gateway integration)
                        Format: "hostname:port" or "service-name.namespace.svc.cluster.local:port"
                      type: string
                    healthCheck:
                      description: HealthCheck defines health checking configuration
                        for this endpoint
                      properties:
                        enabled:
                          default: true
                          description: Enabled controls whether health checking is
                            active
                          type: boolean
                        healthyThreshold:
                          default: 2
                          description: HealthyThreshold is the number of consecutive
                            successful checks for healthy status
                          format: int32
                          minimum: 1
                          type: integer
                        interval:
                          default: 10s
                          description: Interval defines how often to perform health
                            checks
                          type: string
                        path:
                          default: /health
                          description: Path is the HTTP path for health checks (HTTP/HTTPS
                            protocols only)
                          type: string
                        timeout:
                          default: 3s
                          description: Timeout defines the timeout for health check
                            requests
                          type: string
                        unhealthyThreshold:
                          default: 3
                          description: UnhealthyThreshold is the number of consecutive
                            failed checks for unhealthy status
                          format: int32
                          minimum: 1
                          type: integer
                      required:
                      - enabled
                      type: object
                    name:
                      description: Name is a unique identifier for this endpoint within
                        the tailnet
                      pattern: ^[a-z0-9]([-a-z0-9]*[a-z0-9])?$
                      type: string
                    port:
                      description: Port is the port number the service listens on
                      format: int32
                      maximum: 65535
                      minimum: 1
                      type: integer
                    protocol:
                      default: HTTP
                      description: Protocol defines the network protocol (HTTP, HTTPS,
                        TCP, UDP)
                      enum:
                      - HTTP
                      - HTTPS
                      - TCP
                      - UDP
                      type: string
                    tags:
                      description: Tags are Tailscale tags associated with this endpoint
                      items:
                        type: string
                      type: array
                    tailscaleFQDN:
                      description: TailscaleFQDN is the fully qualified domain name
                        in the tailnet
                      type: string
                    tailscaleIP:
                      description: TailscaleIP is the Tailscale IP address of the
                        service
                      type: string
                    weight:
                      default: 1
                      description: Weight defines the load balancing weight for this
                        endpoint
                      format: int32
                      maximum: 100
                      minimum: 1
                      type: integer
                  required:
                  - name
                  - port
                  - protocol
                  - tailscaleFQDN
                  - tailscaleIP
                  type: object
                type: array
              ports:
                description: Ports that the proxy StatefulSets should serve
                items:
                  description: PortMapping defines port configuration for proxy StatefulSets
                  properties:
                    name:
                      description: Name for the port (used in Service creation)
                      type: string
                    port:
                      description: Port number
                      format: int32
                      maximum: 65535
                      minimum: 1
                      type: integer
                    protocol:
                      default: TCP
                      description: Protocol (TCP or UDP)
                      enum:
                      - TCP
                      - UDP
                      type: string
                    targetPort:
                      description: |-
                        TargetPort on the backend service
                        If not specified, defaults to Port
                      format: int32
                      type: integer
                  required:
                  - port
                  type: object
                type: array
              proxy:
                description: Proxy configuration for StatefulSet creation
                properties:
                  affinity:
                    description: Affinity for StatefulSet pods
                    properties:
                      nodeAffinity:
                        description: NodeAffinity describes node affinity scheduling
                          rules
                        properties:
                          requiredDuringSchedulingIgnoredDuringExecution:
                            description: RequiredDuringSchedulingIgnoredDuringExecution
                              specifies hard node constraints
                            properties:
                              nodeSelectorTerms:
                                description: NodeSelectorTerms is a list of node selector
                                  terms
                                items:
                                  description: NodeSelectorTerm is a simplified version
                                    of corev1.NodeSelectorTerm
                                  properties:
                                    matchExpressions:
                                      description: MatchExpressions is a list of node
                                        selector requirements by node's labels
                                      items:
                                        description: NodeSelectorRequirement is a
                                          simplified version of corev1.NodeSelectorRequirement
                                        properties:
                                          key:
                                            description: Key is the label key that
                                              the selector applies to
                                            type: string
                                          operator:
                                            description: Operator represents a key's
                                              relationship to a set of values
                                            enum:
                                            - In
                                            - NotIn
                                            - Exists
                                            - DoesNotExist
                                            - Gt
                                            - Lt
                                            type: string
                                          values:
                                            description: Values is an array of string
                                              values
                                            items:
                                              type: string
                                            type: array
                                        required:
                                        - key
                                        - operator
                                        type: object
                                      type: array
                                  type: object
                                type: array
                            required:
                            - nodeSelectorTerms
                            type: object
                        type: object
                      podAffinity:
                        description: PodAffinity describes pod affinity scheduling
                          rules
                        properties:
                          requiredDuringSchedulingIgnoredDuringExecution:
                            description: RequiredDuringSchedulingIgnoredDuringExecution
                              specifies hard pod constraints
                            items:
                              description: PodAffinityTerm is a simplified version
                                of corev1.PodAffinityTerm
                              properties:
                                labelSelector:
                                  description: LabelSelector is a label query over
                                    a set of resources
                                  properties:
                                    matchExpressions:
                                      description: matchExpressions is a list of label
                                        selector requirements. The requirements are
                                        ANDed.
                                      items:
                                        description: |-
                                          A label selector requirement is a selector that contains values, a key, and an operator that
                                          relates the key and values.
                                        properties:
                                          key:
                                            description: key is the label key that
                                              the selector applies to.
                                            type: string
                                          operator:
                                            description: |-
                                              operator represents a key's relationship to a set of values.
                                              Valid operators are In, NotIn, Exists and DoesNotExist.
                                            type: string
                                          values:
                                            description: |-
                                              values is an array of string values. If the operator is In or NotIn,
                                              the values array must be non-empty. If the operator is Exists or DoesNotExist,
                                              the values array must be empty. This array is replaced during a strategic
                                              merge patch.
                                            items:
                                              type: string
                                            type: array
                                            x-kubernetes-list-type: atomic
                                        required:
                                        - key
                                        - operator
                                        type: object
                                      type: array
                                      x-kubernetes-list-type: atomic
                                    matchLabels:
                                      additionalProperties:
                                        type: string
                                      description: |-
                                        matchLabels is a map of {key,value} pairs. A single {key,value} in the matchLabels
                                        map is equivalent to an element of matchExpressions, whose key field is "key", the
                                        operator is "In", and the values array contains only "value". The requirements are ANDed.
                                      type: object
                                  type: object
                                  x-kubernetes-map-type: atomic
                                topologyKey:
                                  description: TopologyKey is the key of node labels
                                  type: string
                              required:
                              - topologyKey
                              type: object
                            type: array
                        type: object
                      podAntiAffinity:
                        description: PodAntiAffinity describes pod anti-affinity scheduling
                          rules
                        properties:
                          requiredDuringSchedulingIgnoredDuringExecution:
                            description: RequiredDuringSchedulingIgnoredDuringExecution
                              specifies hard pod anti-constraints
                            items:
                              description: PodAffinityTerm is a simplified version
                                of corev1.PodAffinityTerm
                              properties:
                                labelSelector:
                                  description: LabelSelector is a label query over
                                    a set of resources
                                  properties:
                                    matchExpressions:
                                      description: matchExpressions is a list of label
                                        selector requirements. The requirements are
                                        ANDed.
                                      items:
                                        description: |-
                                          A label selector requirement is a selector that contains values, a key, and an operator that
                                          relates the key and values.
                                        properties:
                                          key:
                                            description: key is the label key that
                                              the selector applies to.
                                            type: string
                                          operator:
                                            description: |-
                                              operator represents a key's relationship to a set of values.
                                              Valid operators are In, NotIn, Exists and DoesNotExist.
                                            type: string
                                          values:
                                            description: |-
                                              values is an array of string values. If the operator is In or NotIn,
                                              the values array must be non-empty. If the operator is Exists or DoesNotExist,
                                              the values array must be empty. This array is replaced during a strategic
                                              merge patch.
                                            items:
                                              type: string
                                            type: array
                                            x-kubernetes-list-type: atomic
                                        required:
                                        - key
                                        - operator
                                        type: object
                                      type: array
                                      x-kubernetes-list-type: atomic
                                    matchLabels:
                                      additionalProperties:
                                        type: string
                                      description: |-
                                        matchLabels is a map of {key,value} pairs. A single {key,value} in the matchLabels
                                        map is equivalent to an element of matchExpressions, whose key field is "key", the
                                        operator is "In", and the values array contains only "value". The requirements are ANDed.
                                      type: object
                                  type: object
                                  x-kubernetes-map-type: atomic
                                topologyKey:
                                  description: TopologyKey is the key of node labels
                                  type: string
                              required:
                              - topologyKey
                              type: object
                            type: array
                        type: object
                    type: object
                  connectionType:
                    default: bidirectional
                    description: 'Connection type: ingress, egress, or bidirectional'
                    enum:
                    - ingress
                    - egress
                    - bidirectional
                    type: string
                  image:
                    description: Image for the Tailscale proxy containers
                    type: string
                  nodeSelector:
                    additionalProperties:
                      type: string
                    description: NodeSelector for StatefulSet pods
                    type: object
                  replicas:
                    default: 2
                    description: Number of proxy replicas
                    format: int32
                    minimum: 1
                    type: integer
                  resources:
                    description: Resources for the proxy containers
                    properties:
                      limits:
                        additionalProperties:
                          type: string
                        description: Limits describes the maximum amount of resources
                          required
                        type: object
                      requests:
                        additionalProperties:
                          type: string
                        description: Requests describes the minimum amount of resources
                          required
                        type: object
                    type: object
                  tolerations:
                    description: Tolerations for StatefulSet pods
                    items:
                      description: Toleration defines toleration for StatefulSet pods
                      properties:
                        effect:
                          description: Effect indicates the taint effect to match
                          enum:
                          - NoSchedule
                          - PreferNoSchedule
                          - NoExecute
                          type: string
                        key:
                          description: Key is the taint key that the toleration applies
                            to
                          type: string
                        operator:
                          description: Operator represents a key's relationship to
                            the value
                          enum:
                          - Exists
                          - Equal
                          type: string
                        tolerationSeconds:
                          description: TolerationSeconds represents the period of
                            time the toleration
                          format: int64
                          type: integer
                        value:
                          description: Value is the taint value the toleration matches
                            to
                          type: string
                      type: object
                    type: array
                type: object
              tags:
                description: Tags for the Tailscale machines (used in ACL policies)
                items:
                  type: string
                type: array
              tailnet:
                description: Tailnet identifies which tailnet these endpoints belong
                  to
                type: string
            required:
            - tailnet
            type: object
          status:
            description: TailscaleEndpointsStatus defines the observed state of TailscaleEndpoints
            properties:
              autoDiscoveryStatus:
                description: AutoDiscoveryStatus provides details about the auto-discovery
                  process
                properties:
                  apiStatus:
                    description: APIStatus status of Tailscale API communication
                    properties:
                      averageResponseTime:
                        description: AverageResponseTime average API response time
                        type: string
                      baseURL:
                        description: BaseURL the API base URL being used
                        type: string
                      capabilities:
                        description: Capabilities lists available API capabilities
                        items:
                          type: string
                        type: array
                      connected:
                        description: Connected indicates if API communication is working
                        type: boolean
                      lastError:
                        description: LastError provides details about the most recent
                          API error
                        properties:
                          code:
                            description: Code is a machine-readable error code
                            type: string
                          component:
                            description: Component identifies which component generated
                              the error
                            enum:
                            - Controller
                            - ExtensionServer
                            - TailscaleAPI
                            - ServiceDiscovery
                            - RouteGeneration
                            - Validation
                            - StatefulSet
                            - HealthCheck
                            - OAuth
                            - PolicyEngine
                            type: string
                          context:
                            additionalProperties:
                              type: string
                            description: Context provides additional context about
                              the error
                            type: object
                          httpStatusCode:
                            description: HTTPStatusCode provides HTTP status code
                              for API-related errors
                            format: int32
                            type: integer
                          lastRetry:
                            description: LastRetry timestamp of the last retry attempt
                            format: date-time
                            type: string
                          message:
                            description: Message is a human-readable error message
                            type: string
                          resolutionHint:
                            description: ResolutionHint provides guidance on how to
                              resolve the error
                            type: string
                          resourceRef:
                            description: ResourceRef identifies the specific resource
                              that caused the error
                            properties:
                              group:
                                description: Group is the group of the target resource.
                                maxLength: 253
                                pattern: ^$|^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$
                                type: string
                              kind:
                                description: Kind is the kind of the target resource.
                                maxLength: 63
                                minLength: 1
                                pattern: ^[a-zA-Z]([-a-zA-Z0-9]*[a-zA-Z0-9])?$
                                type: string
                              name:
                                description: Name is the name of the target resource.
                                maxLength: 253
                                minLength: 1
                                type: string
                              namespace:
                                description: Namespace is the namespace of the target
                                  resource.
                                maxLength: 63
                                minLength: 1
                                pattern: ^[a-z0-9]([-a-z0-9]*[a-z0-9])?$
                                type: string
                              sectionName:
                                description: SectionName is the name of a section
                                  within the target resource.
                                maxLength: 253
                                minLength: 1
                                pattern: ^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$
                                type: string
                            required:
                            - group
                            - kind
                            - name
                            type: object
                          retries:
                            description: Retries indicates how many times this operation
                              has been retried
                            format: int32
                            type: integer
                          severity:
                            description: Severity indicates the severity of the error
                            enum:
                            - Critical
                            - High
                            - Medium
                            - Low
                            - Info
                            type: string
                          timestamp:
                            description: Timestamp when the error occurred
                            format: date-time
                            type: string
                        required:
                        - code
                        - component
                        - message
                        - retries
                        - timestamp
                        type: object
                      lastSuccessfulCall:
                        description: LastSuccessfulCall timestamp of last successful
                          API call
                        format: date-time
                        type: string
                      rateLimitRemaining:
                        description: RateLimitRemaining API rate limit remaining
                        format: int32
                        type: integer
                      rateLimitReset:
                        description: RateLimitReset when the rate limit resets
                        format: date-time
                        type: string
                      requestCount:
                        description: RequestCount total number of API requests made
                        format: int64
                        type: integer
                      userAgent:
                        description: UserAgent the user agent string being used
                        type: string
                    required:
                    - connected
                    type: object
                  devicesMatchingCriteria:
                    description: DevicesMatchingCriteria devices that matched discovery
                      criteria
                    type: integer
                  discoveryDuration:
                    description: DiscoveryDuration how long the last discovery took
                    type: string
                  discoveryErrors:
                    description: DiscoveryErrors errors encountered during discovery
                    items:
                      description: DetailedError provides comprehensive error information
                        with context
                      properties:
                        code:
                          description: Code is a machine-readable error code
                          type: string
                        component:
                          description: Component identifies which component generated
                            the error
                          enum:
                          - Controller
                          - ExtensionServer
                          - TailscaleAPI
                          - ServiceDiscovery
                          - RouteGeneration
                          - Validation
                          - StatefulSet
                          - HealthCheck
                          - OAuth
                          - PolicyEngine
                          type: string
                        context:
                          additionalProperties:
                            type: string
                          description: Context provides additional context about the
                            error
                          type: object
                        httpStatusCode:
                          description: HTTPStatusCode provides HTTP status code for
                            API-related errors
                          format: int32
                          type: integer
                        lastRetry:
                          description: LastRetry timestamp of the last retry attempt
                          format: date-time
                          type: string
                        message:
                          description: Message is a human-readable error message
                          type: string
                        resolutionHint:
                          description: ResolutionHint provides guidance on how to
                            resolve the error
                          type: string
                        resourceRef:
                          description: ResourceRef identifies the specific resource
                            that caused the error
                          properties:
                            group:
                              description: Group is the group of the target resource.
                              maxLength: 253
                              pattern: ^$|^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$
                              type: string
                            kind:
                              description: Kind is the kind of the target resource.
                              maxLength: 63
                              minLength: 1
                              pattern: ^[a-zA-Z]([-a-zA-Z0-9]*[a-zA-Z0-9])?$
                              type: string
                            name:
                              description: Name is the name of the target resource.
                              maxLength: 253
                              minLength: 1
                              type: string
                            namespace:
                              description: Namespace is the namespace of the target
                                resource.
                              maxLength: 63
                              minLength: 1
                              pattern: ^[a-z0-9]([-a-z0-9]*[a-z0-9])?$
                              type: string
                            sectionName:
                              description: SectionName is the name of a section within
                                the target resource.
                              maxLength: 253
                              minLength: 1
                              pattern: ^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$
                              type: string
                          required:
                          - group
                          - kind
                          - name
                          type: object
                        retries:
                          description: Retries indicates how many times this operation
                            has been retried
                          format: int32
                          type: integer
                        severity:
                          description: Severity indicates the severity of the error
                          enum:
                          - Critical
                          - High
                          - Medium
                          - Low
                          - Info
                          type: string
                        timestamp:
                          description: Timestamp when the error occurred
                          format: date-time
                          type: string
                      required:
                      - code
                      - component
                      - message
                      - retries
                      - timestamp
                      type: object
                    type: array
                  enabled:
                    description: Enabled indicates if auto-discovery is enabled
                    type: boolean
                  lastDiscoveryTime:
                    description: LastDiscoveryTime when auto-discovery was last performed
                    format: date-time
                    type: string
                  tagSelectorsApplied:
                    description: TagSelectorsApplied number of tag selectors applied
                    type: integer
                  totalDevicesScanned:
                    description: TotalDevicesScanned total devices found in tailnet
                    type: integer
                  vipServicesDiscovered:
                    description: VIPServicesDiscovered VIP services found
                    type: integer
                required:
                - devicesMatchingCriteria
                - enabled
                - totalDevicesScanned
                type: object
              conditions:
                description: Conditions represent the current state of the TailscaleEndpoints
                items:
                  description: Condition contains details for one aspect of the current
                    state of this API Resource.
                  properties:
                    lastTransitionTime:
                      description: |-
                        lastTransitionTime is the last time the condition transitioned from one status to another.
                        This should be when the underlying condition changed.  If that is not known, then using the time when the API field changed is acceptable.
                      format: date-time
                      type: string
                    message:
                      description: |-
                        message is a human readable message indicating details about the transition.
                        This may be an empty string.
                      maxLength: 32768
                      type: string
                    observedGeneration:
                      description: |-
                        observedGeneration represents the .metadata.generation that the condition was set based upon.
                        For instance, if .metadata.generation is currently 12, but the .status.conditions[x].observedGeneration is 9, the condition is out of date
                        with respect to the current state of the instance.
                      format: int64
                      minimum: 0
                      type: integer
                    reason:
                      description: |-
                        reason contains a programmatic identifier indicating the reason for the condition's last transition.
                        Producers of specific condition types may define expected values and meanings for this field,
                        and whether the values are considered a guaranteed API.
                        The value should be a CamelCase string.
                        This field may not be empty.
                      maxLength: 1024
                      minLength: 1
                      pattern: ^[A-Za-z]([A-Za-z0-9_,:]*[A-Za-z0-9_])?$
                      type: string
                    status:
                      description: status of the condition, one of True, False, Unknown.
                      enum:
                      - "True"
                      - "False"
                      - Unknown
                      type: string
                    type:
                      description: type of condition in CamelCase or in foo.example.com/CamelCase.
                      maxLength: 316
                      pattern: ^([a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*/)?(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])$
                      type: string
                  required:
                  - lastTransitionTime
                  - message
                  - reason
                  - status
                  - type
                  type: object
                type: array
                x-kubernetes-list-map-keys:
                - type
                x-kubernetes-list-type: map
              devices:
                description: |-
                  Devices contains information about Tailscale machines created by this resource
                  Similar to ProxyGroup devices in the official Tailscale k8s-operator
                items:
                  description: |-
                    TailscaleDevice represents a Tailscale machine/device created by the operator
                    Similar to the ProxyGroup device status in the official Tailscale k8s-operator
                  properties:
                    authKeyID:
                      description: AuthKeyID is the ID of the auth key used to create
                        this device (for cleanup)
                      type: string
                    connected:
                      description: Connected indicates if the device is currently
                        connected to the tailnet
                      type: boolean
                    hostname:
                      description: Hostname is the Tailscale hostname of the device
                      type: string
                    lastSeen:
                      description: LastSeen is when the device was last seen online
                      format: date-time
                      type: string
                    nodeID:
                      description: NodeID is the Tailscale node ID
                      type: string
                    online:
                      description: Online indicates if the device is currently online
                      type: boolean
                    statefulSetPod:
                      description: StatefulSetPod is the name of the pod backing this
                        device
                      type: string
                    tags:
                      description: Tags are the Tailscale tags applied to this device
                      items:
                        type: string
                      type: array
                    tailscaleFQDN:
                      description: TailscaleFQDN is the fully qualified domain name
                        in the tailnet
                      type: string
                    tailscaleIP:
                      description: TailscaleIP is the Tailscale IP address assigned
                        to the device
                      type: string
                  type: object
                type: array
              discoveredEndpoints:
                description: DiscoveredEndpoints is the count of endpoints discovered
                  via auto-discovery
                type: integer
              endpointStatus:
                description: EndpointStatus provides detailed status for each endpoint
                items:
                  description: EndpointStatus provides status information for a specific
                    endpoint
                  properties:
                    connectionStatus:
                      description: ConnectionStatus tracks the status of StatefulSet
                        connections
                      properties:
                        connectionErrors:
                          description: ConnectionErrors recent connection errors
                          items:
                            description: DetailedError provides comprehensive error
                              information with context
                            properties:
                              code:
                                description: Code is a machine-readable error code
                                type: string
                              component:
                                description: Component identifies which component
                                  generated the error
                                enum:
                                - Controller
                                - ExtensionServer
                                - TailscaleAPI
                                - ServiceDiscovery
                                - RouteGeneration
                                - Validation
                                - StatefulSet
                                - HealthCheck
                                - OAuth
                                - PolicyEngine
                                type: string
                              context:
                                additionalProperties:
                                  type: string
                                description: Context provides additional context about
                                  the error
                                type: object
                              httpStatusCode:
                                description: HTTPStatusCode provides HTTP status code
                                  for API-related errors
                                format: int32
                                type: integer
                              lastRetry:
                                description: LastRetry timestamp of the last retry
                                  attempt
                                format: date-time
                                type: string
                              message:
                                description: Message is a human-readable error message
                                type: string
                              resolutionHint:
                                description: ResolutionHint provides guidance on how
                                  to resolve the error
                                type: string
                              resourceRef:
                                description: ResourceRef identifies the specific resource
                                  that caused the error
                                properties:
                                  group:
                                    description: Group is the group of the target
                                      resource.
                                    maxLength: 253
                                    pattern: ^$|^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$
                                    type: string
                                  kind:
                                    description: Kind is the kind of the target resource.
                                    maxLength: 63
                                    minLength: 1
                                    pattern: ^[a-zA-Z]([-a-zA-Z0-9]*[a-zA-Z0-9])?$
                                    type: string
                                  name:
                                    description: Name is the name of the target resource.
                                    maxLength: 253
                                    minLength: 1
                                    type: string
                                  namespace:
                                    description: Namespace is the namespace of the
                                      target resource.
                                    maxLength: 63
                                    minLength: 1
                                    pattern: ^[a-z0-9]([-a-z0-9]*[a-z0-9])?$
                                    type: string
                                  sectionName:
                                    description: SectionName is the name of a section
                                      within the target resource.
                                    maxLength: 253
                                    minLength: 1
                                    pattern: ^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$
                                    type: string
                                required:
                                - group
                                - kind
                                - name
                                type: object
                              retries:
                                description: Retries indicates how many times this
                                  operation has been retried
                                format: int32
                                type: integer
                              severity:
                                description: Severity indicates the severity of the
                                  error
                                enum:
                                - Critical
                                - High
                                - Medium
                                - Low
                                - Info
                                type: string
                              timestamp:
                                description: Timestamp when the error occurred
                                format: date-time
                                type: string
                            required:
                            - code
                            - component
                            - message
                            - retries
                            - timestamp
                            type: object
                          type: array
                        egressReady:
                          description: EgressReady indicates if egress connection
                            is ready
                          type: boolean
                        ingressReady:
                          description: IngressReady indicates if ingress connection
                            is ready
                          type: boolean
                        lastConnectionAttempt:
                          description: LastConnectionAttempt timestamp of last connection
                            attempt
                          format: date-time
                          type: string
                        tailscaleConnected:
                          description: TailscaleConnected indicates if Tailscale connection
                            is established
                          type: boolean
                      type: object
                    discoverySource:
                      description: DiscoverySource indicates how this endpoint was
                        discovered
                      enum:
                      - Manual
                      - AutoDiscovery
                      - VIPService
                      - TagSelector
                      type: string
                    externalTarget:
                      description: ExternalTarget shows the configured external target
                      type: string
                    healthCheckDetails:
                      description: HealthCheckDetails provides detailed health check
                        information
                      properties:
                        averageResponseTime:
                          description: AverageResponseTime average health check response
                            time
                          type: string
                        configuration:
                          description: Configuration shows the current health check
                            configuration
                          properties:
                            enabled:
                              default: true
                              description: Enabled controls whether health checking
                                is active
                              type: boolean
                            healthyThreshold:
                              default: 2
                              description: HealthyThreshold is the number of consecutive
                                successful checks for healthy status
                              format: int32
                              minimum: 1
                              type: integer
                            interval:
                              default: 10s
                              description: Interval defines how often to perform health
                                checks
                              type: string
                            path:
                              default: /health
                              description: Path is the HTTP path for health checks
                                (HTTP/HTTPS protocols only)
                              type: string
                            timeout:
                              default: 3s
                              description: Timeout defines the timeout for health
                                check requests
                              type: string
                            unhealthyThreshold:
                              default: 3
                              description: UnhealthyThreshold is the number of consecutive
                                failed checks for unhealthy status
                              format: int32
                              minimum: 1
                              type: integer
                          required:
                          - enabled
                          type: object
                        enabled:
                          description: Enabled indicates if health checking is enabled
                            for this endpoint
                          type: boolean
                        lastCheckDuration:
                          description: LastCheckDuration duration of the last health
                            check
                          type: string
                        lastCheckResponse:
                          description: LastCheckResponse details about the last health
                            check response
                          properties:
                            errorMessage:
                              description: ErrorMessage error message if the check
                                failed
                              type: string
                            responseHeaders:
                              additionalProperties:
                                type: string
                              description: ResponseHeaders key response headers (for
                                HTTP/HTTPS checks)
                              type: object
                            responseTime:
                              description: ResponseTime how long the check took
                              type: string
                            statusCode:
                              description: StatusCode HTTP status code (for HTTP/HTTPS
                                checks)
                              format: int32
                              type: integer
                            success:
                              description: Success indicates if the health check succeeded
                              type: boolean
                            timestamp:
                              description: Timestamp when the check was performed
                              format: date-time
                              type: string
                          required:
                          - responseTime
                          - success
                          - timestamp
                          type: object
                        recentFailures:
                          description: RecentFailures details about recent health
                            check failures
                          items:
                            description: HealthCheckFailure provides details about
                              a health check failure
                            properties:
                              duration:
                                description: Duration how long the failed check took
                                type: string
                              errorMessage:
                                description: ErrorMessage detailed error message
                                type: string
                              errorType:
                                description: ErrorType categorizes the type of failure
                                enum:
                                - Timeout
                                - ConnectionRefused
                                - DNSResolution
                                - HTTPError
                                - TCPError
                                - UDPError
                                - TLSError
                                - Unknown
                                type: string
                              retryAttempt:
                                description: RetryAttempt which retry attempt this
                                  was
                                format: int32
                                type: integer
                              statusCode:
                                description: StatusCode HTTP status code if applicable
                                format: int32
                                type: integer
                              timestamp:
                                description: Timestamp when the failure occurred
                                format: date-time
                                type: string
                            required:
                            - errorMessage
                            - errorType
                            - timestamp
                            type: object
                          type: array
                        successfulChecks:
                          description: SuccessfulChecks total number of successful
                            health checks
                          format: int64
                          type: integer
                        successiveFailures:
                          description: SuccessiveFailures number of consecutive failed
                            health checks
                          format: int32
                          type: integer
                        successiveSuccesses:
                          description: SuccessiveSuccesses number of consecutive successful
                            health checks
                          format: int32
                          type: integer
                        totalChecks:
                          description: TotalChecks total number of health checks performed
                          format: int64
                          type: integer
                      required:
                      - enabled
                      - successfulChecks
                      - successiveFailures
                      - successiveSuccesses
                      - totalChecks
                      type: object
                    healthStatus:
                      description: HealthStatus indicates the health check status
                      enum:
                      - Healthy
                      - Unhealthy
                      - Unknown
                      - Disabled
                      type: string
                    lastError:
                      description: LastError provides context about the most recent
                        error
                      properties:
                        code:
                          description: Code is a machine-readable error code
                          type: string
                        component:
                          description: Component identifies which component generated
                            the error
                          enum:
                          - Controller
                          - ExtensionServer
                          - TailscaleAPI
                          - ServiceDiscovery
                          - RouteGeneration
                          - Validation
                          - StatefulSet
                          - HealthCheck
                          - OAuth
                          - PolicyEngine
                          type: string
                        context:
                          additionalProperties:
                            type: string
                          description: Context provides additional context about the
                            error
                          type: object
                        httpStatusCode:
                          description: HTTPStatusCode provides HTTP status code for
                            API-related errors
                          format: int32
                          type: integer
                        lastRetry:
                          description: LastRetry timestamp of the last retry attempt
                          format: date-time
                          type: string
                        message:
                          description: Message is a human-readable error message
                          type: string
                        resolutionHint:
                          description: ResolutionHint provides guidance on how to
                            resolve the error
                          type: string
                        resourceRef:
                          description: ResourceRef identifies the specific resource
                            that caused the error
                          properties:
                            group:
                              description: Group is the group of the target resource.
                              maxLength: 253
                              pattern: ^$|^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$
                              type: string
                            kind:
                              description: Kind is the kind of the target resource.
                              maxLength: 63
                              minLength: 1
                              pattern: ^[a-zA-Z]([-a-zA-Z0-9]*[a-zA-Z0-9])?$
                              type: string
                            name:
                              description: Name is the name of the target resource.
                              maxLength: 253
                              minLength: 1
                              type: string
                            namespace:
                              description: Namespace is the namespace of the target
                                resource.
                              maxLength: 63
                              minLength: 1
                              pattern: ^[a-z0-9]([-a-z0-9]*[a-z0-9])?$
                              type: string
                            sectionName:
                              description: SectionName is the name of a section within
                                the target resource.
                              maxLength: 253
                              minLength: 1
                              pattern: ^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$
                              type: string
                          required:
                          - group
                          - kind
                          - name
                          type: object
                        retries:
                          description: Retries indicates how many times this operation
                            has been retried
                          format: int32
                          type: integer
                        severity:
                          description: Severity indicates the severity of the error
                          enum:
                          - Critical
                          - High
                          - Medium
                          - Low
                          - Info
                          type: string
                        timestamp:
                          description: Timestamp when the error occurred
                          format: date-time
                          type: string
                      required:
                      - code
                      - component
                      - message
                      - retries
                      - timestamp
                      type: object
                    lastHealthCheck:
                      description: LastHealthCheck is when the endpoint was last health
                        checked
                      format: date-time
                      type: string
                    name:
                      description: Name identifies the endpoint
                      type: string
                    tags:
                      description: Tags are the Tailscale tags associated with this
                        endpoint
                      items:
                        type: string
                      type: array
                    tailscaleIP:
                      description: TailscaleIP is the endpoint's Tailscale IP
                      type: string
                    weight:
                      description: Weight is the current load balancing weight
                      format: int32
                      type: integer
                  required:
                  - discoverySource
                  - healthStatus
                  - name
                  - tailscaleIP
                  type: object
                type: array
              healthyEndpoints:
                description: HealthyEndpoints is the count of endpoints passing health
                  checks
                type: integer
              lastSync:
                description: LastSync indicates when endpoint discovery last succeeded
                format: date-time
                type: string
              operationalMetrics:
                description: OperationalMetrics provides performance and operational
                  insights
                properties:
                  apiCallCount:
                    description: APICallCount total API calls made to Tailscale
                    format: int64
                    type: integer
                  apiRateLimitHits:
                    description: APIRateLimitHits number of times rate limits were
                      hit
                    format: int64
                    type: integer
                  averageReconcileTime:
                    description: AverageReconcileTime average reconciliation duration
                    type: string
                  errorRate:
                    description: ErrorRate percentage of failed operations as a string
                      (e.g., "15.5%")
                    type: string
                  failedReconciles:
                    description: FailedReconciles number of failed reconciliations
                    format: int64
                    type: integer
                  lastReconcileTime:
                    description: LastReconcileTime when the last reconciliation occurred
                    format: date-time
                    type: string
                  reconcileCount:
                    description: ReconcileCount total number of reconciliations
                    format: int64
                    type: integer
                  reconcileDuration:
                    description: ReconcileDuration how long the last reconciliation
                      took
                    type: string
                  successfulReconciles:
                    description: SuccessfulReconciles number of successful reconciliations
                    format: int64
                    type: integer
                  throughputPerHour:
                    description: ThroughputPerHour operations completed per hour
                    format: int64
                    type: integer
                required:
                - failedReconciles
                - lastReconcileTime
                - reconcileCount
                - successfulReconciles
                type: object
              recentErrors:
                description: RecentErrors tracks recent operational errors with context
                items:
                  description: DetailedError provides comprehensive error information
                    with context
                  properties:
                    code:
                      description: Code is a machine-readable error code
                      type: string
                    component:
                      description: Component identifies which component generated
                        the error
                      enum:
                      - Controller
                      - ExtensionServer
                      - TailscaleAPI
                      - ServiceDiscovery
                      - RouteGeneration
                      - Validation
                      - StatefulSet
                      - HealthCheck
                      - OAuth
                      - PolicyEngine
                      type: string
                    context:
                      additionalProperties:
                        type: string
                      description: Context provides additional context about the error
                      type: object
                    httpStatusCode:
                      description: HTTPStatusCode provides HTTP status code for API-related
                        errors
                      format: int32
                      type: integer
                    lastRetry:
                      description: LastRetry timestamp of the last retry attempt
                      format: date-time
                      type: string
                    message:
                      description: Message is a human-readable error message
                      type: string
                    resolutionHint:
                      description: ResolutionHint provides guidance on how to resolve
                        the error
                      type: string
                    resourceRef:
                      description: ResourceRef identifies the specific resource that
                        caused the error
                      properties:
                        group:
                          description: Group is the group of the target resource.
                          maxLength: 253
                          pattern: ^$|^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$
                          type: string
                        kind:
                          description: Kind is the kind of the target resource.
                          maxLength: 63
                          minLength: 1
                          pattern: ^[a-zA-Z]([-a-zA-Z0-9]*[a-zA-Z0-9])?$
                          type: string
                        name:
                          description: Name is the name of the target resource.
                          maxLength: 253
                          minLength: 1
                          type: string
                        namespace:
                          description: Namespace is the namespace of the target resource.
                          maxLength: 63
                          minLength: 1
                          pattern: ^[a-z0-9]([-a-z0-9]*[a-z0-9])?$
                          type: string
                        sectionName:
                          description: SectionName is the name of a section within
                            the target resource.
                          maxLength: 253
                          minLength: 1
                          pattern: ^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$
                          type: string
                      required:
                      - group
                      - kind
                      - name
                      type: object
                    retries:
                      description: Retries indicates how many times this operation
                        has been retried
                      format: int32
                      type: integer
                    severity:
                      description: Severity indicates the severity of the error
                      enum:
                      - Critical
                      - High
                      - Medium
                      - Low
                      - Info
                      type: string
                    timestamp:
                      description: Timestamp when the error occurred
                      format: date-time
                      type: string
                  required:
                  - code
                  - component
                  - message
                  - retries
                  - timestamp
                  type: object
                type: array
                x-kubernetes-list-type: atomic
              statefulSetRefs:
                description: StatefulSetRefs tracks the StatefulSets created for endpoint
                  connections
                items:
                  description: StatefulSetReference tracks a StatefulSet created for
                    an endpoint connection
                  properties:
                    connectionType:
                      description: ConnectionType indicates whether this is an ingress
                        or egress connection
                      enum:
                      - ingress
                      - egress
                      type: string
                    desiredReplicas:
                      description: DesiredReplicas desired number of replicas
                      format: int32
                      type: integer
                    endpointName:
                      description: EndpointName identifies which endpoint this StatefulSet
                        serves
                      type: string
                    errorMessage:
                      description: ErrorMessage provides context if the StatefulSet
                        is in an error state
                      type: string
                    lastStatusChange:
                      description: LastStatusChange when the status last changed
                      format: date-time
                      type: string
                    name:
                      description: Name of the StatefulSet
                      type: string
                    namespace:
                      description: Namespace of the StatefulSet
                      type: string
                    readyReplicas:
                      description: ReadyReplicas number of ready replicas
                      format: int32
                      type: integer
                    status:
                      description: Status indicates the current state of the StatefulSet
                      enum:
                      - Ready
                      - Pending
                      - Failed
                      - Scaling
                      - Unknown
                      type: string
                  required:
                  - connectionType
                  - endpointName
                  - name
                  - namespace
                  type: object
                type: array
              statefulSets:
                description: StatefulSets contains information about the created StatefulSets
                items:
                  description: StatefulSetInfo provides information about created
                    StatefulSets
                  properties:
                    createdAt:
                      description: CreatedAt is when the StatefulSet was created
                      format: date-time
                      type: string
                    name:
                      description: Name of the StatefulSet
                      type: string
                    namespace:
                      description: Namespace of the StatefulSet
                      type: string
                    readyReplicas:
                      description: ReadyReplicas is the number of ready replicas
                      format: int32
                      type: integer
                    replicas:
                      description: Replicas is the desired number of replicas
                      format: int32
                      type: integer
                    service:
                      description: Service is the name of the associated Service
                      type: string
                    type:
                      description: Type indicates the StatefulSet type (ingress, egress,
                        bidirectional)
                      type: string
                  required:
                  - name
                  - namespace
                  - readyReplicas
                  - replicas
                  - type
                  type: object
                type: array
              tagSelectorResults:
                description: TagSelectorResults provides results of tag selector matching
                items:
                  description: TagSelectorResult provides results of tag selector
                    matching
                  properties:
                    errorMessage:
                      description: ErrorMessage error message if selector application
                        failed
                      type: string
                    excludedDevices:
                      description: ExcludedDevices number of devices that were excluded
                      type: integer
                    lastApplied:
                      description: LastApplied when this selector was last applied
                      format: date-time
                      type: string
                    matchedDeviceNames:
                      description: MatchedDeviceNames names of devices that matched
                        (for debugging)
                      items:
                        type: string
                      type: array
                    matchedDevices:
                      description: MatchedDevices number of devices that matched this
                        selector
                      type: integer
                    selector:
                      description: Selector the tag selector that was applied
                      properties:
                        operator:
                          default: Exists
                          description: Operator defines the selection operator
                          enum:
                          - In
                          - NotIn
                          - Exists
                          - DoesNotExist
                          type: string
                        tag:
                          description: Tag is the full tag key (e.g., "tag:service",
                            "tag:environment")
                          type: string
                        values:
                          description: |-
                            Values are the tag values to match (for In/NotIn operators)
                            For "tag:environment", values might be ["production", "staging"]
                          items:
                            type: string
                          type: array
                      required:
                      - tag
                      type: object
                    success:
                      description: Success indicates if the selector was applied successfully
                      type: boolean
                  required:
                  - lastApplied
                  - matchedDevices
                  - selector
                  - success
                  type: object
                type: array
              totalEndpoints:
                description: TotalEndpoints is the total count of endpoints (discovered
                  + manually configured)
                type: integer
              unhealthyEndpoints:
                description: UnhealthyEndpoints is the count of endpoints failing
                  health checks
                type: integer
            required:
            - discoveredEndpoints
            - healthyEndpoints
            - totalEndpoints
            - unhealthyEndpoints
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
